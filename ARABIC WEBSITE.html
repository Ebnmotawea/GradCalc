<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>حاسبة الدرجات</title>
      <style>
        body {
          font-family: 'Sakkal Majalla', Arial, sans-serif; /* Set Sakkal Majalla as the default font */
          text-align: center;
          margin: 0;
          padding: 0;
          background-color: #f9f9f9;
          font-size: 18px; /* Base font size for body text */
        }
        h1 {
          font-size: 32px; /* Increased font size for main headers */
          margin-top: 20px;
        }
        h2 {
          font-size: 28px; /* Increased font size for subheaders */
        }
        p {
          font-size: 20px; /* Increased font size for paragraphs */
        }
        .container {
          margin: 20px auto;
          padding: 20px;
          max-width: 600px;
          background: white;
          border-radius: 8px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        button {
          background-color: #8A1538; /* Default button background */
          color: white; /* Default button text color */
          border: none;
          padding: 15px 25px; /* Larger padding for larger buttons */
          margin: 10px;
          border-radius: 5px;
          cursor: pointer;
          font-weight: bold; /* Make button text bold */
          font-size: 20px; /* Increased font size for button text */
          font-family: 'Sakkal Majalla', Arial, sans-serif; /* Set font for button text */
        }
        button:hover {
          background-color: #5c1028; /* Darker shade on hover */
        }
        #goBack {
          background-color: white; /* White background for the back button */
          color: #8A1538; /* Text color for the back button */
          border: none;
          padding: 15px 25px; /* Larger padding for larger buttons */
          border-radius: 5px;
          cursor: pointer;
          font-size: 20px; /* Increased font size for the Go Back button */
          position: fixed;
          top: 20px;
          right: 20px; /* Align with RTL layout */
          z-index: 1000;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Smooth shadow */
          font-weight: bold; /* Make Go Back button text bold */
          font-family: 'Sakkal Majalla', Arial, sans-serif; /* Set font for the Go Back button */
        }
        #goBack:hover {
          background-color: #f2f2f2; /* Light gray on hover */
        }
        table {
          margin: 20px auto;
          border-collapse: collapse; /* Remove double borders */
          width: 100%;
          border: 2px solid #8A1538; /* Add border around the table */
        }
        th, td {
          font-size: 20px; /* Increased font size for table cells */
          padding: 10px;
          text-align: right;
          border: 1px solid #8A1538; /* Add border around each cell */
        }
        th {
          background-color: #f4f4f4; /* Light background for headers */
        }
        .warning {
          color: red;
          font-size: 18px; /* Increased font size for warning text */
          margin-top: 10px;
          font-family: 'Sakkal Majalla', Arial, sans-serif; /* Apply font to warning text */
        }
        .result {
          font-size: 22px; /* Increased font size for result text */
          margin-top: 20px;
          font-family: 'Sakkal Majalla', Arial, sans-serif; /* Apply font to result text */
        }
      </style>
</head>
<body>

  <div class="container">
    <button id="goBack" style="display: none; position: absolute; top: 20px; right: 20px;">العودة للخلف</button>
    <img src="https://imgur.com/a/iDJvd53" alt="Logo" style="width: 150px; height: auto;">
    <div id="start">
      <p><strong>مرحبًا! اختر الفصل الدراسي:</strong></p>
      <button id="firstSemester">الفصل الدراسي الأول</button>
      <button id="secondSemester">الفصل الدراسي الثاني</button>
      <p>بواسطة: محمد عادل مطاوع</p>
    </div>

    <div id="semester1" style="display: none;">
      <h2>درجات الفصل الدراسي الأول</h2>
      <table>
        <thead>
          <tr>
            <th>المادة</th>
            <th>الدرجة (من 40)</th>
          </tr>
        </thead>
        <tbody id="semester1Table">
          <tr><td>الرياضيات</td><td><input type="number" class="gradeInput" data-max="40" max="40"></td></tr>
          <tr><td>الكيمياء</td><td><input type="number" class="gradeInput" data-max="40" max="40"></td></tr>
          <tr><td>الفيزياء</td><td><input type="number" class="gradeInput" data-max="40" max="40"></td></tr>
          <tr><td>الأحياء</td><td><input type="number" class="gradeInput" data-max="40" max="40"></td></tr>
          <tr><td>اللغة العربية</td><td><input type="number" class="gradeInput" data-max="40" max="40"></td></tr>
          <tr><td>اللغة الإنجليزية</td><td><input type="number" class="gradeInput" data-max="40" max="40"></td></tr>
          <tr><td>الدراسات الإسلامية</td><td><input type="number" class="gradeInput" data-max="40" max="40"></td></tr>
          <tr><td>الإختياري</td><td><input type="number" class="gradeInput" data-max="40" max="40"></td></tr>
        </tbody>
      </table>
      <button id="calculateSemester1">احسب</button>
      <p class="warning" id="semester1Warning" style="display: none;">يرجى ملء جميع الدرجات.</p>
      <p class="result" id="semester1Result" style="display: none;"></p>
      <button id="predictFinal" style="display: none;">توقع المجموع النهائي</button>
    </div>

    <div id="semester2" style="display: none;">
        <h2>درجات الفصل الدراسي الثاني</h2>
        <div style="display: flex; flex-direction: column; align-items: center; margin-bottom: 20px;">
           <div id="semester1PercentageContainer" style="display: none; margin-bottom: 20px;">
             <p id="semester1PercentageLabel">اكتب نسبة الفصل الدراسي الأول:</p>
             <input type="number" id="semester1Percentage" placeholder="مثال: 95%" style="text-align: center; padding: 5px; width: 150px;">
             <p id="semester1PercentageWarning" class="warning" style="display: none;"></p>
           </div>
        </div>
        <table>
            <thead>
                <tr>
                    <th>المادة</th>
                    <th>الدرجة (من 60)</th>
                </tr>
            </thead>
            <tbody id="semester2DirectTable">
                <tr><td>الرياضيات</td><td><input type="number" class="gradeInput" data-max="60" max="60"></td></tr>
                <tr><td>الكيمياء</td><td><input type="number" class="gradeInput" data-max="60" max="60"></td></tr>
                <tr><td>الفيزياء</td><td><input type="number" class="gradeInput" data-max="60" max="60"></td></tr>
                <tr><td>الأحياء</td><td><input type="number" class="gradeInput" data-max="60" max="60"></td></tr>
                <tr><td>اللغة العربية</td><td><input type="number" class="gradeInput" data-max="60" max="60"></td></tr>
                <tr><td>اللغة الإنجليزية</td><td><input type="number" class="gradeInput" data-max="60" max="60"></td></tr>
                <tr><td>الدراسات الإسلامية</td><td><input type="number" class="gradeInput" data-max="60" max="60"></td></tr>
                <tr><td>الإختياري</td><td><input type="number" class="gradeInput" data-max="60" max="60"></td></tr>
            </tbody>
        </table>
        <button id="calculateSemester2">احسب المجموع النهائي</button>
        <p class="warning" id="semester2Warning" style="display: none;">يرجى ملء جميع الدرجات.</p>
        <p class="result" id="semester2Result" style="display: none;"></p>
    </div>
<script>
    // Select the Go Backward button
    const goBackButton = document.getElementById('goBack');
    // Reset Second Semester Table and State
    function resetSecondSemester() {
        const gradeInputs = document.querySelectorAll('#semester2DirectTable .gradeInput');
        gradeInputs.forEach(input => {
            input.value = ''; // Clear inputs
        });
        document.getElementById('semester2Warning').style.display = 'none'; // Hide warnings
        document.getElementById('semester2Result').style.display = 'none'; // Hide results
    }

    // Navigation logic for Go Backward button
    function showGoBackButton(callback) {
        goBackButton.style.display = 'block';
        goBackButton.onclick = callback;
    }

    // Hide the Go Backward button
    function hideGoBackButton() {
        goBackButton.style.display = 'none';
        goBackButton.onclick = null;
    }

    let accessedFromSemester2Direct = false; // Flag to track how we accessed semester 2

    // Show First Semester Section
    document.getElementById('firstSemester').addEventListener('click', function () {
        document.getElementById('start').style.display = 'none';
        document.getElementById('semester1').style.display = 'block';
        showGoBackButton(() => {
            document.getElementById('semester1').style.display = 'none';
            document.getElementById('semester2').style.display = 'none'; // Ensure second semester is hidden
            resetSecondSemester(); // Reset second semester inputs and warnings
            document.getElementById('start').style.display = 'block';
            hideGoBackButton();
        });
    });

    // Show Second Semester Section Directly
    document.getElementById('secondSemester').addEventListener('click', function () {
        accessedFromSemester2Direct = true; // Direct access
        document.getElementById('start').style.display = 'none';
        document.getElementById('semester2').style.display = 'block';

        // Show the First Semester Percentage field
        const semester1PercentageContainer = document.getElementById('semester1PercentageContainer');
        const semester1PercentageInput = document.getElementById('semester1Percentage');
        semester1PercentageInput.value = ''; // Clear any previous value
        semester1PercentageInput.removeAttribute('readonly'); // Make it editable
        semester1PercentageContainer.style.display = 'block'; // Show container

        showGoBackButton(() => {
            document.getElementById('semester2').style.display = 'none';
            document.getElementById('start').style.display = 'block';
            hideGoBackButton();
        });
    });

    // Calculate First Semester Grades
    document.getElementById('calculateSemester1').addEventListener('click', function () {
        const gradeInputs = document.querySelectorAll('#semester1Table .gradeInput');
        let total = 0;
        let allFilled = true;

        gradeInputs.forEach(input => {
            const value = parseFloat(input.value);
            if (isNaN(value) || value < 0 || value > parseFloat(input.dataset.max)) {
                allFilled = false;
            } else {
                total += value;
            }
        });

        const warning = document.getElementById('semester1Warning');
        const result = document.getElementById('semester1Result');
        const predictButton = document.getElementById('predictFinal');

        if (!allFilled) {
            warning.style.display = 'block';
            warning.textContent = 'يرجى إدخال درجات صحيحة لجميع المواد (من 0 إلى 40).';
            result.style.display = 'none';
            predictButton.style.display = 'none';
        } else {
            warning.style.display = 'none';
            const percentage = ((total / 320) * 100).toFixed(2); // Calculate percentage
            result.style.display = 'block';
            result.textContent = `النسبة المئوية الإجمالية للفصل الدراسي الأول هي: ${percentage}%`;
            predictButton.style.display = 'block';
        }
    });

    // Predict Final Total
    document.getElementById('predictFinal').addEventListener('click', function () {
        const semester1Result = document.getElementById('semester1Result').textContent || '';
        const semester1Percentage = parseFloat(semester1Result.split(':')[1]?.trim() || 0);

        if (isNaN(semester1Percentage)) {
            alert('يرجى حساب النسبة المئوية للفصل الدراسي الأول قبل التنبؤ بالمجموع النهائي.');
            return;
        }

        // Show second semester section and pre-fill the percentage
        document.getElementById('semester1').style.display = 'none';
        document.getElementById('semester2').style.display = 'block';
        const semester1PercentageInput = document.getElementById('semester1Percentage');
        semester1PercentageInput.value = semester1Percentage;
        semester1PercentageInput.setAttribute('readonly', 'true'); // Make it read-only

        // Hide the container since it is pre-filled
        document.getElementById('semester1PercentageContainer').style.display = 'none';

        // Update Go Back button behavior
        showGoBackButton(() => {
            document.getElementById('semester2').style.display = 'none';
            document.getElementById('semester1').style.display = 'block';

            // Update Go Back button for returning to the main page
            showGoBackButton(() => {
                document.getElementById('semester1').style.display = 'none';
                document.getElementById('start').style.display = 'block';
                hideGoBackButton();
            });
        });
    });

    // Calculate Final Total After Second Semester (Prediction)
    document.getElementById('calculateSemester2').addEventListener('click', function () {
        const semester1PercentageInput = document.getElementById('semester1Percentage');
        const semester1PercentageWarning = document.getElementById('semester1PercentageWarning');
        const semester1Percentage = parseFloat(semester1PercentageInput.value);

        // Validate the first semester percentage
        if (isNaN(semester1Percentage) || semester1Percentage < 0 || semester1Percentage > 100) {
            semester1PercentageWarning.style.display = 'block';
            semester1PercentageWarning.textContent = 'يرجى إدخال نسبة صحيحة للفصل الدراسي الأول (من 0 إلى 100).';
            return;
        } else {
            semester1PercentageWarning.style.display = 'none';
        }

        const semester1Total = (semester1Percentage / 100) * 320; // Calculate semester 1 total from percentage
        const gradeInputs = document.querySelectorAll('#semester2DirectTable .gradeInput');
        let semester2Total = 0;
        let allFilled = true;

        // Loop through the second semester grades
        gradeInputs.forEach(input => {
            const value = parseFloat(input.value);
            if (isNaN(value) || value < 0 || value > parseFloat(input.dataset.max)) {
                allFilled = false;
            } else {
                semester2Total += value;
            }
        });

        const warning = document.getElementById('semester2Warning');
        const result = document.getElementById('semester2Result');

        // Check if all second semester grades are filled
        if (!allFilled) {
            warning.style.display = 'block';
            warning.textContent = 'يرجى إدخال درجات صحيحة لجميع المواد (من 0 إلى 60).';
            result.style.display = 'none';
        } else {
            warning.style.display = 'none';
            const finalTotal = semester1Total + semester2Total; // Combine totals
            const finalPercentage = ((finalTotal / 800) * 100).toFixed(2); // Calculate final percentage
            result.style.display = 'block';
            const isPrediction = accessedFromSemester2Direct ? "" : "المتوقعة ";
            result.textContent = `النسبة الإجمالية ${isPrediction}للمجموع النهائي هي: ${finalPercentage}%`;
        }
    });
</script>
</body>
</html>
